# Pixel Bead 项目核心功能与实现逻辑

本方案整合了对 `pixelbeads.org` 和 `pixelbeads.pics` 的深入分析，提取了拼豆类工具的核心商业价值与技术实现路径。

## 一、 核心功能梳理

### 1. 核心转换引擎 (Core Conversion)
- **图像像素化**：将用户上传的图片下采样至目标网格尺寸（支持 10x10 至 300x300）。
- **智能色彩映射**：
    - 支持 **Perler, Hama, Artkal** 等国际主流拼豆品牌色板。
    - 允许切换“卡通模式”（主导色优先）或“写实模式”（平均色优先）。
- **去噪优化**：自动或手动移除低频“杂色”，使成品图案更整洁、易于手工拼制。

### 2. 构建与管理 (Build & Management)
- **实时预览**：在调整分辨率、色板、相似度等参数时立即反馈结果。
- **拼豆计数与物料单 (BOM)**：实时统计每种颜色所需珠子的确切数量，生成购物清单（Shopping List）。
- **调色板管理**：用户可以启用/禁用特定颜色，以适配自己手中的库存。

### 3. 图案微调 (Editing Tools)
- **手动编辑器**：提供画笔、油漆桶、橡皮擦工具，允许在生成后进行细节修正。
- **辅助对齐**：针对已经是像素图的输入，提供精确的裁剪与网格对齐工具（Crop Tool）。

### 4. 导出与隐私 (Export & Privacy)
- **专业 PDF 导出**：生成多页、可打印的 PDF，包含网格线、颜色码（Symbol Mapper）和详细图例。
- **本地化处理**：强调数据隐私，所有图像处理均在浏览器本地 canvas 完成，不上传服务器。

---

## 二、 核心功能逻辑实现 (Technical Logic)

### 1. 图像处理链路 (Processing Pipeline)
- **输入层**：利用 `HTML5 Canvas API` 读取文件数据。
- **处理层 (Quantization Logic)**：
    1. **色彩空间转换**：将 RGB 转换为 **Lab 空间**，以实现更符合人类视觉感知的颜色距离计算。
    2. **最近邻搜寻**：对网格中每个像素，通过欧几里得距离寻找色板中与其 Delta-E 值最小的颜色。
    3. **降采样处理**：使用双三次插值（Bicubic）或最近邻法（Nearest Neighbor）进行缩放。
- **状态层**：将图案存储为 `Uint8Array` 或 2D 数组，索引指向色板库的 ID。

### 2. 交互逻辑 (Interaction Logic)
- **撤销/重做栈**：记录所有的画笔操作，确保用户可以随时回退。
- **实时统计引擎**：当矩阵数据发生变化时，利用哈希表同步计算各色 ID 的频次。

### 3. PDF 生成逻辑 (Export Engine)
- 利用 `jspdf` 或 `pdf-lib`：
    - 绘制高频网格（Grid Overlay）。
    - 在格内渲染代表色块或字符符号（如 A, B, 1, 2...）。
    - 自动分页：大图（如 200x200）自动切分为多张 A4 纸。

---

## 三、 UI/UX 设计规范 (Design Principles)

### 1. 现代视觉风格
- **符合场景**：整体 UI 采用“像素感”设计语言，但在呈现上保持现代极简主义。
- **配色方案**：使用高对比度的实色（Solid Colors），强调专业工具感。
- **组件设计**：
    - 按钮采用硬边缘（Sharp Corners）或极小圆角。
    - 交互状态使用填充色的明暗变化而非渐变。

### 2. 绝对禁忌：禁用渐变色 (No Gradients)
- **背景/卡片**：使用纯色背景（如 `#FFFFFF` 或深色主题下的 `#1A1A1A`）。
- **面板阴影**：改用实色 Border 或者硬阴影（Offset-only box-shadow with no blur），增强“块状”质感。
- **图标**：采用单色、平面化（Flat Design）风格。

### 3. 信息架构布局
- **工具区 (Left)**：垂直排列的功能图标，点击即用。
- **编辑区 (Center)**：最大化展示图案画布，带响应式缩放与平移功能。
- **属性/状态区 (Right)**：展示当前色板、拼豆总数、占比分析、以及下载 CTA 按钮。
