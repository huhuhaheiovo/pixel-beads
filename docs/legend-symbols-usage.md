# 图例符号使用说明

## 概述

图例符号功能用于在网格格子太小、无法显示颜色代码文字时，自动使用唯一的 Unicode 符号代替。这确保了即使在小格子中也能识别不同的颜色。

## 自动使用方式

### 1. 数据生成

图例符号会在生成 MARD 色板数据时自动分配：

```bash
npm run gen:mard
```

**分配规则：**
- 只为**短代码（≤2 字符）**分配图例符号
- 每个短代码都有**唯一的符号**，不会重复
- 符号从 **489 个唯一 Unicode 符号**中按顺序分配

### 2. 网格显示（网页界面）

在网页界面中，图例符号会根据格子大小自动切换：

- **格子大小 ≥ 14px**：显示颜色代码文字（如 `A1`、`D4`）
- **格子大小 8-14px**：显示图例符号（如 `■`、`◛`）
- **格子大小 < 8px**：不显示任何内容

**控制开关：**
- 点击工具栏的 `#` 按钮可以开启/关闭显示
- 调整左侧 Settings 中的 **Cell Size** 滑块来控制格子大小

### 3. PDF 导出

在导出 PDF 时，图例符号也会自动使用：

- **格子大小 ≥ 3mm**：显示颜色代码文字
- **格子大小 1.5-3mm**：显示图例符号
- **格子大小 < 1.5mm**：不显示任何内容

**图例页面：**
- PDF 的图例页面会显示每个颜色及其图例符号
- 格式：`颜色名 (代码) [符号]`，例如：`D4 (D4) [◛]`

## 符号分配示例

查看已分配的符号：

```typescript
// 在 src/lib/generatedMard.ts 中可以看到：
{ id: "MARD:A1", code: "A1", legendSymbol: "■" }
{ id: "MARD:D4", code: "D4", legendSymbol: "◛" }
{ id: "MARD:F2", code: "F2", legendSymbol: "▧" }
// ... 更多
```

## 自定义符号

如果需要修改符号分配，编辑 `scripts/generate-mard.mjs`：

```javascript
// 在 scripts/generate-mard.mjs 中修改 symbols 数组
const symbols = [
  "▵", "▴", "▾", "▿", // 三角形变体
  "○", "●", "◉", "◎", // 圆形变体
  // ... 添加更多 Unicode 符号
];
```

然后重新运行：

```bash
npm run gen:mard
```

## 符号类型

当前使用的符号包括：

- **几何形状**：方块、圆形、三角形、菱形
- **箭头**：各种方向的箭头
- **星形**：不同样式的星形
- **数学符号**：数学和技术符号
- **块元素**：方块绘制字符

## 注意事项

1. **符号唯一性**：每个短代码都有唯一符号，不会重复
2. **自动切换**：系统会根据格子大小自动选择显示文字或符号
3. **仅限短代码**：只有代码长度 ≤2 字符的颜色才有图例符号
4. **PDF 兼容性**：所有符号都是 Unicode 字符，在 PDF 中正常显示

## 查看符号分配

在浏览器中：
- 将 **Cell Size** 调整到 8-14px 之间
- 开启 `#` 按钮（显示代码）
- 短代码的颜色会显示为图例符号

在 PDF 中：
- 导出 PDF 后，查看图例页面可以看到每个颜色的符号
- 如果网格格子很小，图案中也会显示符号而不是文字

